#!/bin/bash

# systemd-sleep hook for LG Buddy
# Arguments: 
#   $1: "pre" (before sleep) or "post" (after wake)
#   $2: "suspend", "hibernate", "hybrid-sleep", or "suspend-then-hibernate"

USERNAME="zany130"
ALGA_PATH="/home/${USERNAME}/.local/bin/alga"
TV_INPUT="HDMI_1"  # Change to your PC's input (e.g., HDMI_1, HDMI_2, HDMI_3, HDMI_4)

case "$1/$2" in
    pre/*)
        logger -t lg-buddy-sleep "Pre-sleep: Turning off TV before $2"
        sudo -u "$USERNAME" "$ALGA_PATH" power off 2>&1 | logger -t lg-buddy-sleep
        ;;
        
    post/*)
        logger -t lg-buddy-sleep "Post-sleep: Woke up from $2, turning on TV"
        
        sleep 2  # Wait for network
        
        sudo -u "$USERNAME" "$ALGA_PATH" power on 2>&1 | logger -t lg-buddy-sleep
        sleep 7
        sudo -u "$USERNAME" "$ALGA_PATH" input set "$TV_INPUT" 2>&1 | logger -t lg-buddy-sleep
        ;;
esac

exit 0
